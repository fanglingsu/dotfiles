#!/usr/bin/env bash
# toggle the xdebug module
# include some nice messaging functions
source functions.sh
source ~/.phpbrew/bashrc

if [[ $EUID -ne 0 ]]; then
    write_error "This script must be run as root"
    exit 1
fi

loaded=$(phpbrew ext show xdebug | grep 'Loaded: yes')

if [ $(phpbrew ext show xdebug | grep -c 'Loaded: yes') -gt 0 ]; then
    action_message "disable xdebug"
    phpbrew ext disable xdebug &> /dev/null
else
    action_message "enable xdebug"
    phpbrew ext enable xdebug &> /dev/null
fi

# restart the http service to make the changed to take effect
systemctl restart httpd.service
action_status $?
